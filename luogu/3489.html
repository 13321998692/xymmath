<!DOCTYPE html>
<html class="no-js">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title> P3489 [POI2009]WIE-Hexer - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1555852930:ThVkXnJyiHWmWLKZ8V04H9jz1Bk7Nbm53EVHREo18rU=">
<link rel="stylesheet" href="https://cdn.luogu.org/css/amazeui.min.css"/>
<link rel="stylesheet" href="https://cdn.luogu.org/css/katex.min.css"/>
<link rel="stylesheet" href="https://cdn.luogu.org/css/luogu3.css?ver=20190102">
<link rel="stylesheet" href="https://cdn.luogu.org/css/highlight_tomorrow.css">
<link rel="stylesheet" href="https://cdn.luogu.org/markdown-palettes/markdown-palettes.css?ver=20190219">
<script src="https://cdn.luogu.org/js/jquery-2.1.1.min.js"></script>
<script src="https://cdn.luogu.org/js/luogu3_pre.js?ver=20190101"></script>
<link rel="shortcut icon" type="image/x-icon" href="https://cdn.luogu.org/images/favicon3.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.org/fe/loader.css?ver=20190417">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentUser%22%3Anull%2C%22currentTemplate%22%3A%22Excited%22%2C%22currentData%22%3A%7B%22shortHeader%22%3Afalse%2C%22pageName%22%3A%22%5Cu9898%5Cu76ee%5Cu8be6%5Cu60c5%22%7D%2C%22currentMeta%22%3A%7B%22title%22%3A%22%20P3489%20%5BPOI2009%5DWIE-Hexer%22%7D%7D"));</script>
<script>window._release = '20190417';</script>
<script src="https://cdn.luogu.org/fe/loader.js?ver=20190417" charset="utf-8" defer></script>
</head>
<body>
<div id="app-header"></div>
<nav id="app-sidenav"></nav>
<div id="app-body"></div>
<script>
    function scrollToId (id) {
        $('html, body').animate({
            scrollTop: ($('#' + id).offset().top)
        }, 500);
    }
</script>
<style>
    .lg-toolbar {
        display: none;
    }

    #app-body { /* Unused in fallback FE */
        display: none;
    }

    #app-body-new{
        display: block;
        margin-bottom: 2em;
        position: relative;
        box-sizing: border-box;
        max-width: 100%;
    }

    @media (min-width: 576px) {
        #app-body-new {
            margin-left: 70px;
        }
    }

    code {
        font-family: monospace, "Courier New";
    }

</style>
<div id="app-body-new">
<div class="lg-toolbar" data-am-sticky>
<h1><a href="/recordnew/lists?uid=&pid=P3489" target="_blank"><strong class=""><i class="am-icon-minus"></i></strong></a> P3489 [POI2009]WIE-Hexer</h1>
</div>
<div class="am-g lg-main-content">
<div class="am-u-md-4 lg-right" name="problemright">
<section class="am-panel am-panel-default lg-summary" id="psummary">
<div class="lg-summary-content">
<ul class="am-list am-list-static lg-summary-list">
<li>
<ul class="am-avg-sm-2"><li><span class="lg-bignum-num">120<small></small></span><span class="lg-bignum-text">通过</span></li><li><span class="lg-bignum-num">310<small></small></span><span class="lg-bignum-text">提交</span></li></ul>
</li>
<li>
<strong>题目提供者</strong>
<span class="lg-right"><a class='lg-fg-purple lg-bold' href="/space/show?uid=3" target="_blank">洛谷</a></span>
</li>
<li>
<strong>评测方式</strong>
<span class="lg-right"><b>云端评测</b></span>
</li>
<li><strong>标签</strong>
<span class="lg-tag am-badge am-radius lg-bg-pink am-hide" data-tagid="162">Dijkstra</span>
<span class="lg-tag am-badge am-radius lg-bg-pink am-hide" data-tagid="3">动态规划,动规,dp</span>
<span class="lg-tag am-badge am-radius lg-bg-bluelight" data-tagid="57">POI</span>
<span class="lg-tag am-badge am-radius lg-bg-green" data-tagid="26">2009</span>
<span class="lg-tag am-badge am-radius lg-bg-orange" data-tagid="319">高性能</span>
<style>.lg-tag { cursor: pointer; }</style>
<script>
                                $(".lg-tag").click(function() {
                                    window.open("/problemnew/lists?tag=" + $(this).attr('data-tagid'));
                                })
                            </script>
</li>
<li><strong>难度</strong>
<span class="lg-right"><span class="am-badge am-radius lg-bg-bluelight">提高+/省选-</span></span>
</li>
<li><strong>时空限制</strong>
<span class="lg-right">1000ms / 128MB</span>
</li>
</ul>
</div>
<p>
<button class="am-btn am-btn-danger am-btn-sm" id="submit" pid="P3489">
<i class="am-icon-paper-plane"></i> 提交
</button>
<a target="_blank" href="/problemnew/solution/P3489" class="am-btn am-btn-primary am-btn-sm">
<i class="am-icon-book"></i> 题解
</a>
<a data-pjax href="/recordnew/lists?pid=P3489" class="am-btn am-btn-primary am-btn-sm" title="查看本题提交记录">
<i class="am-icon-pie-chart"></i>
</a>
<button class="am-btn am-btn-primary am-btn-sm lg-pointer" name="showtag" title="显示算法标签">
<i class="am-icon-tags"></i>
</button>
</p>
<li>提示：收藏到任务计划后，可在首页查看。</li>
<p>
<a class="am-btn am-btn-danger am-btn-sm" href="/fe/problem/P3489" target="_blank">体验新版界面</a>
</p>
</section>
<section class="am-panel am-panel-default lg-summary">
<h2>最新讨论
<a onclick="$('#discuss-lists').show();$(this).hide();" class="am-btn am-btn-primary am-btn-sm lg-right" title="查看本题讨论">
显示
</a>
</h2>
<ul class="am-list am-list-static lg-summary-list" style="display: none" id="discuss-lists">
<li><a data-pjax href="/discuss/show?postid=80132" class="am-padding-0">有没有dalao帮我看看为啥是…</a>
</li>
<li><a data-pjax href="/discuss/show?postid=25955" class="am-padding-0">输入啥啊</a>
</li>
<li><a data-pjax href="/discuss/show?postid=15647" class="am-padding-0">题中链接坏掉了</a>
</li>
<div style="overflow: auto">
<a data-pjax href="/discuss/lists?forumname=P3489" class="am-btn am-btn-primary am-btn-sm lg-right">进入讨论版</a>
</div>
</ul>
</section>
<section class="am-panel am-panel-default lg-summary am-hide-sm">
<h2>推荐的相关题目
<a onclick="$('#recommendation-list').show();$(this).hide();" class="am-btn am-btn-primary am-btn-sm lg-right" title="查看推荐题目">
显示
</a>
</h2>
<ul class="am-list am-list-static lg-summary-list" id="recommendation-list" style="display: none">
<li>
<a class='colored' href="/problemnew/show/P4067" target="_blank"><b>P4067</b> [SDOI2016]储能表</a>
</li>
<li>
<a class='colored' href="/problemnew/show/P1251" target="_blank"><b>P1251</b> 餐巾计划问题</a>
</li>
<li>
<a class='colored' href="/problemnew/show/P3809" target="_blank"><b>P3809</b> 【模板】后缀排序</a>
</li>
<li>
<a class='colored' href="/problemnew/show/P3959" target="_blank"><b>P3959</b> 宝藏</a>
</li>
<li>
<a class='colored' href="/problemnew/show/P2486" target="_blank"><b>P2486</b> [SDOI2011]染色</a>
</li>
</ul>
</section>
</div>
<div class="am-u-md-8 lg-right" name="problemleft">
<div class="lg-content-left">
<div class="lg-article am-g">
<h2>题目描述</h2>
<p>Byteasar has become a hexer - a conqueror of monsters.</p>
<p>Currently he is to return to his hometown Byteburg. The way home, alas, leads through a land full of beasts. Fortunately the habitants, forced to fight the monsters for centuries, have mastered the art of blacksmithery - they are now capable of making special swords that are very efficient against the beasts.</p>
<p>The land Byteasar wanders through is quite vast: many towns lie there, and many roads connect them.</p>
<p>These roads do not cross outside the towns (mostly because some of them are underground passages).</p>
<p>Byteasar has gathered all practical information about the land (all hexers like to know these things).</p>
<p>He knows what kind of monsters he may come across each of the roads and how much time he needs to walk it down.</p>
<p>He also knows in which villages there are blacksmiths and against what kinds of monsters the swords that they make work.</p>
<p>Byteasar wants to get back to Byteburg as soon as possible.</p>
<p>As a hexer he is quite ashamed that he does not know the best route, and that he has no sword on him at the moment.</p>
<p>Help him find the shortest path to Byteburg such that whenever he could meet some king of monster, previously he would have a chance to get an appropriate sword to fight the beast.</p>
<p>You need not worry about the number or weight of the swords - every hexer is as strong as an ox, so he can carry (virtually) unlimited number of equipment, swords in particular.</p>
<p>大陆上有n个村庄，m条双向道路，p种怪物，k个铁匠，每个铁匠会居住在一个村庄里，你到了那个村庄后可以让他给你打造剑，每个铁匠打造的剑都可以对付一些特定种类的怪物，每条道路上都可能出现一些特定种类的怪物，每条道路都有一个通过所需要的时间，现在要从1走到n，初始的时候你没有剑，要求在经过一条道路的时候，对于任意一种可能出现在这条道路上的的怪物，你都有已经有至少一把剑可以对付他，求从1走到n的最短时间（打造剑不需要时间）</p>
<h2>输入输出格式</h2>
<strong>输入格式：</strong><br>
<p><p>The first line of the standard input holds four integers: $n,m,p,k$ ($1\le n\le 200,0\le m\le 3000,1\le p\le 13,0\le k\le n$),separated by single spaces, that denote respectively:</p>
<p>the number of towns, the number of roads connecting them,the number of different kinds of monsters and the number of blacksmiths.</p>
<p>The towns are numbered from $1$ to $n$ in such a way that $n$ is Byteburg's number and $1$ is the number of the village which Byteasar starts in. The monster kinds are numbered from $1$ to $p$.</p>
<p>In the following $k$ lines the profiles of successive blacksmiths are given,one per line. The $(i+1)$-st line holds the integers $w_i,q_i,r_{i,1}&lt;r_{i,2}&lt;...&lt;r_{i,q_i}$($1\le w_i\le n,1\le q_i\le p,1\le r_{i,j}\le p$),separated by single spaces, that denote respectively: the number of town in which the blacksmith lives, the number of different kinds of monsters against which his swords are efficient, and the kinds of monsters themselves (in increasing order). Note that a town may have more than one blacksmith.</p>
<p>Then $m$ lines with roads' descriptions follow.The $(k+i+1)$-th line holds the integers$v_i,w_i,t_i,s_i,u_{i,1}&lt;u_{i,2}&lt;...&lt;u_{i,s_i}$($1\le v_i&lt;w_i\le n,1\le t_i\le 500,0\le s_i\le p,1\le u_{i,j}\le p$)separated by single spaces, that denote respectively: the towns that the road connects, the time needed to walk down the road (same in both directions), the number of different kinds of monsters that may appear on that road, and finally the kinds of monsters themselves (in increasing order). No two roads connect the same pair of towns.</p></p>
<strong>输出格式：</strong><br>
<p><p>Your programme is to print out one integer to the standard output - the minimum summary time required to reach Byteburg.</p>
<p>Should reaching Byteburg be impossible, the number should be $-1$.</p></p>
<h2>输入输出样例</h2>
<div class="am-g">
<div class="am-u-md-6 copy-region">
<strong>输入样例#1：</strong>
<a class="am-badge am-radius lg-bg-orange sample-copy">复制</a>
<pre>6 7 4 2
2 1 2
3 2 1 3
1 2 2 0
2 3 9 0
1 4 2 1 2
2 5 3 0
4 5 5 2 2 3
4 6 18 0
5 6 3 2 1 2
</pre>
</div>
<div class="am-u-md-6 copy-region">
<strong>输出样例#1：</strong>
<a class="am-badge am-radius lg-bg-orange sample-copy">复制</a>
<pre>24
</pre>
</div>
</div>
<h2>说明</h2>
<p>大陆上有n个村庄，m条双向道路，p种怪物，k个铁匠，每个铁匠会居住在一个村庄里，你到了那个村庄后可以让他给你打造剑，每个铁匠打造的剑都可以对付一些特定种类的怪物，每条道路上都可能出现一些特定种类的怪物，每条道路都有一个通过所需要的时间，现在要从1走到n，初始的时候你没有剑，要求在经过一条道路的时候，对于任意一种可能出现在这条道路上的的怪物，你都有已经有至少一把剑可以对付他，求从1走到n的最短时间（打造剑不需要时间）</p>
</div>
<div class='lg-article-sub am-g' id="sub"></div>
</div>
</div>
</div>
<div class="am-modal am-modal-prompt" tabindex="-1" id="confirm">
<div class="am-modal-dialog">
<div class="am-modal-hd" id="memtitle">提示</div>
<div class="am-modal-bd" id="memadmin">
标程仅供做题后或实在无思路时参考。<br>
请自觉、自律地使用该功能并请对自己的学习负责。<br>
如果发现恶意抄袭标程，将按照I类违反进行处理。<br>
</div>
<div class="am-modal-footer">
<span class="am-modal-btn" data-am-modal-cancel>取消</span>
<span class="am-modal-btn" data-am-modal-confirm>确定</span>
</div>
</div>
</div>
<script>
        $(document).ready(function () {
            $("#expandstd").click(function () {
                $('#confirm').modal({
                    relatedTarget: this,
                    onConfirm: function (e) {
                        $("#stdcode").slideDown();
                        $("#expandstd").hide();
                    }
                });
            });
            $("#submit").click(
                function () {
                    hide_artile();
                    $(document).scrollTop($(document).scrollTop() - 80);
                    var pid = $(this).attr("pid");
                    $.get("/problem/ajax_submit?pid=" + pid, function (data) {
                        var arr = eval('(' + data + ')');
                        if (arr['code'] == 201) {
                            $('.lg-article-sub').html(arr['more']['html']);
                        }
                        else if (arr['code'] == 200) {

                        }
                        else {
                            if (arr['code'] == 0 || arr['code'] == -3) {
                                backarticle();
                            }
                            show_alert("提交失败", arr['message']);
                        }
                    });
                }
            );
            $("button[title].am-btn,a[title].am-btn").poshytip({
                className: 'tip-twitter',
                showTimeout: 1,
                alignTo: 'target',
                alignX: 'center',
                alignY: 'bottom'
            });
            $('[name=showtag]').click(function () {
                $('.am-badge.am-hide').removeClass('am-hide');
            });
            $(".sample-copy").click(function() {
                var element = $(this).parents(".copy-region").find("pre");
                var text = $(element).text();
                var $temp = $("<textarea>");
                $("body").append($temp);
                $temp.val(text).select();
                document.execCommand("copy");
                $temp.remove();
                $(this).text("复制成功").removeClass("lg-bg-orange");

                var e = this;
                setTimeout(function() {
                    $(e).text("复制").addClass("lg-bg-orange");
                }, 500);
            });
        });
    </script>
</div>
<footer id="app-footer"></footer>
<div class="am-modal am-modal-alert" tabindex="-1" id="lg-alert">
<div class="am-modal-dialog">
<div class="am-modal-hd" id="lg-alert-title"></div>
<div class="am-modal-bd" id="lg-alert-message"></div>
<div class="am-modal-footer">
<span class="am-modal-btn">确定</span>
</div>
</div>
</div>
<script src="/js/ace/ace.js"></script>
<script src="https://cdn.luogu.org/js/vendor.js" data-manual></script>
<script src="https://cdn.luogu.org/js/jsmind.js" data-manual></script>
<script src="https://cdn.luogu.org/js/amazeui.min.js"></script>
<script src="https://cdn.luogu.org/js/highcharts.js"></script>
<script src="https://cdn.luogu.org/js/highcharts-more.js"></script>
<script src="/static/katex/katex.min.js"></script>
<script src="/static/katex/contrib/auto-render.min.js"></script>
<script src="https://cdn.luogu.org/markdown-palettes/markdown-palettes.min.js?ver=20190219"></script>
<script src="https://cdn.luogu.org/js/luogu3.js?ver=20190101"></script>
</body>
</html>
