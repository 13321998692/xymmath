<!DOCTYPE html>
<html class="no-js">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title> P2984 [USACO10FEB]给巧克力Chocolate Giving - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1555852684:O/6D3JNKe7+bSXzSjhsp9AACXbZh4bLFdJLcuVJIanA=">
<link rel="stylesheet" href="https://cdn.luogu.org/css/amazeui.min.css"/>
<link rel="stylesheet" href="https://cdn.luogu.org/css/katex.min.css"/>
<link rel="stylesheet" href="https://cdn.luogu.org/css/luogu3.css?ver=20190102">
<link rel="stylesheet" href="https://cdn.luogu.org/css/highlight_tomorrow.css">
<link rel="stylesheet" href="https://cdn.luogu.org/markdown-palettes/markdown-palettes.css?ver=20190219">
<script src="https://cdn.luogu.org/js/jquery-2.1.1.min.js"></script>
<script src="https://cdn.luogu.org/js/luogu3_pre.js?ver=20190101"></script>
<link rel="shortcut icon" type="image/x-icon" href="https://cdn.luogu.org/images/favicon3.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.org/fe/loader.css?ver=20190417">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentUser%22%3Anull%2C%22currentTemplate%22%3A%22Excited%22%2C%22currentData%22%3A%7B%22shortHeader%22%3Afalse%2C%22pageName%22%3A%22%5Cu9898%5Cu76ee%5Cu8be6%5Cu60c5%22%7D%2C%22currentMeta%22%3A%7B%22title%22%3A%22%20P2984%20%5BUSACO10FEB%5D%5Cu7ed9%5Cu5de7%5Cu514b%5Cu529bChocolate%20Giving%22%7D%7D"));</script>
<script>window._release = '20190417';</script>
<script src="https://cdn.luogu.org/fe/loader.js?ver=20190417" charset="utf-8" defer></script>
</head>
<body>
<div id="app-header"></div>
<nav id="app-sidenav"></nav>
<div id="app-body"></div>
<script>
    function scrollToId (id) {
        $('html, body').animate({
            scrollTop: ($('#' + id).offset().top)
        }, 500);
    }
</script>
<style>
    .lg-toolbar {
        display: none;
    }

    #app-body { /* Unused in fallback FE */
        display: none;
    }

    #app-body-new{
        display: block;
        margin-bottom: 2em;
        position: relative;
        box-sizing: border-box;
        max-width: 100%;
    }

    @media (min-width: 576px) {
        #app-body-new {
            margin-left: 70px;
        }
    }

    code {
        font-family: monospace, "Courier New";
    }

</style>
<div id="app-body-new">
<div class="lg-toolbar" data-am-sticky>
<h1><a href="/recordnew/lists?uid=&pid=P2984" target="_blank"><strong class=""><i class="am-icon-minus"></i></strong></a> P2984 [USACO10FEB]给巧克力Chocolate Giving</h1>
</div>
<div class="am-g lg-main-content">
<div class="am-u-md-4 lg-right" name="problemright">
<section class="am-panel am-panel-default lg-summary" id="psummary">
<div class="lg-summary-content">
<ul class="am-list am-list-static lg-summary-list">
<li>
<ul class="am-avg-sm-2"><li><span class="lg-bignum-num">692<small></small></span><span class="lg-bignum-text">通过</span></li><li><span class="lg-bignum-num">1.8<small>K</small><small></small></span><span class="lg-bignum-text">提交</span></li></ul>
</li>
<li>
<strong>题目提供者</strong>
<span class="lg-right"><a class='lg-fg-gray' href="/space/show?uid=20" target="_blank">FarmerJohn2</a></span>
</li>
<li>
<strong>评测方式</strong>
<span class="lg-right"><b>云端评测</b></span>
</li>
<li><strong>标签</strong>
<span class="lg-tag am-badge am-radius lg-bg-pink am-hide" data-tagid="164">SPFA</span>
<span class="lg-tag am-badge am-radius lg-bg-pink am-hide" data-tagid="160">最短路</span>
<span class="lg-tag am-badge am-radius lg-bg-pink am-hide" data-tagid="7">贪心</span>
<span class="lg-tag am-badge am-radius lg-bg-bluelight" data-tagid="46">USACO</span>
<span class="lg-tag am-badge am-radius lg-bg-green" data-tagid="27">2010</span>
<span class="lg-tag am-badge am-radius lg-bg-orange" data-tagid="319">高性能</span>
<style>.lg-tag { cursor: pointer; }</style>
<script>
                                $(".lg-tag").click(function() {
                                    window.open("/problemnew/lists?tag=" + $(this).attr('data-tagid'));
                                })
                            </script>
</li>
<li><strong>难度</strong>
<span class="lg-right"><span class="am-badge am-radius lg-bg-yellow">普及/提高-</span></span>
</li>
<li><strong>时空限制</strong>
<span class="lg-right">1000ms / 128MB</span>
</li>
</ul>
</div>
<p>
<button class="am-btn am-btn-danger am-btn-sm" id="submit" pid="P2984">
<i class="am-icon-paper-plane"></i> 提交
</button>
<a target="_blank" href="/problemnew/solution/P2984" class="am-btn am-btn-primary am-btn-sm">
<i class="am-icon-book"></i> 题解
</a>
<a data-pjax href="/recordnew/lists?pid=P2984" class="am-btn am-btn-primary am-btn-sm" title="查看本题提交记录">
<i class="am-icon-pie-chart"></i>
</a>
<button class="am-btn am-btn-primary am-btn-sm lg-pointer" name="showtag" title="显示算法标签">
<i class="am-icon-tags"></i>
</button>
</p>
<li>提示：收藏到任务计划后，可在首页查看。</li>
<p>
<a class="am-btn am-btn-danger am-btn-sm" href="/fe/problem/P2984" target="_blank">体验新版界面</a>
</p>
</section>
<section class="am-panel am-panel-default lg-summary">
<h2>最新讨论
<a onclick="$('#discuss-lists').show();$(this).hide();" class="am-btn am-btn-primary am-btn-sm lg-right" title="查看本题讨论">
显示
</a>
</h2>
<ul class="am-list am-list-static lg-summary-list" style="display: none" id="discuss-lists">
<li><a data-pjax href="/discuss/show?postid=86352" class="am-padding-0">第二个点？？WA</a>
</li>
<li><a data-pjax href="/discuss/show?postid=65152" class="am-padding-0">为什么开了氧气 WA 最后一个…</a>
</li>
<li><a data-pjax href="/discuss/show?postid=62084" class="am-padding-0">一个好玩的地方</a>
</li>
<li><a data-pjax href="/discuss/show?postid=54689" class="am-padding-0">求助！三个蛋</a>
</li>
<li><a data-pjax href="/discuss/show?postid=43553" class="am-padding-0">为什么SPFA+SLF会RE两个点</a>
</li>
<li><a data-pjax href="/discuss/show?postid=32749" class="am-padding-0">Bellman-Ford为什么错？</a>
</li>
<div style="overflow: auto">
<a data-pjax href="/discuss/lists?forumname=P2984" class="am-btn am-btn-primary am-btn-sm lg-right">进入讨论版</a>
</div>
</ul>
</section>
<section class="am-panel am-panel-default lg-summary am-hide-sm">
<h2>推荐的相关题目
<a onclick="$('#recommendation-list').show();$(this).hide();" class="am-btn am-btn-primary am-btn-sm lg-right" title="查看推荐题目">
显示
</a>
</h2>
<ul class="am-list am-list-static lg-summary-list" id="recommendation-list" style="display: none">
<li>
<a class='colored' href="/problemnew/show/P2951" target="_blank"><b>P2951</b> [USACO09OPEN]捉迷藏Hide and Seek</a>
</li>
<li>
<a class='colored' href="/problemnew/show/P1821" target="_blank"><b>P1821</b> [USACO07FEB]银牛派对Silver Cow Party</a>
</li>
<li>
<a class='colored' href="/problemnew/show/P1396" target="_blank"><b>P1396</b> 营救</a>
</li>
<li>
<a class='colored' href="/problemnew/show/P1629" target="_blank"><b>P1629</b> 邮递员送信</a>
</li>
<li>
<a class='colored' href="/problemnew/show/P1339" target="_blank"><b>P1339</b> [USACO09OCT]热浪Heat Wave</a>
</li>
</ul>
</section>
</div>
<div class="am-u-md-8 lg-right" name="problemleft">
<div class="lg-content-left">
<div class="lg-article am-g">
<h2>题目描述</h2>
<p>Farmer John is distributing chocolates at the barn for Valentine's day, and B (1 &lt;= B &lt;= 25,000) of his bulls have a special cow in mind to receive a chocolate gift.</p>
<p>Each of the bulls and cows is grazing alone in one of the farm's N (2*B &lt;= N &lt;= 50,000) pastures conveniently numbered 1..N and connected by M (N-1 &lt;= M &lt;= 100,000) bidirectional cowpaths of various lengths. Some pastures might be directly connected by more than one cowpath. Cowpath i connects pastures R_i and S_i (1 &lt;= R_i &lt;= N; 1 &lt;= S_i &lt;= N) and has length L_i (1 &lt;= L_i &lt;= 2,000).</p>
<p>Bull i resides in pasture P_i (1 &lt;= P_i &lt;= N) and wishes to give a chocolate to the cow in pasture Q_i (1 &lt;= Q_i &lt;= N).</p>
<p>Help the bulls find the shortest path from their current pasture to the barn (which is located at pasture 1) and then onward to the pasture where their special cow is grazing. The barn connects, one way or another (potentially via other cowpaths and pastures) to every pasture.</p>
<p>As an example, consider a farm with 6 pastures, 6 paths, and 3 bulls (in pastures 2, 3, and 5) who wish to bestow chocolates on their love-objects:</p>
<pre><code class="language-cpp">
                      *1  &lt;-- Bull wants chocolates for pasture 1 cow
             [4]--3--[5]  &lt;-- [5] is the pasture ID
            /  |
           /   |
          4    2          &lt;-- 2 is the cowpath length
         /     |               between [3] and [4]
      [1]--1--[3]*6
     /   \    /
    9     3  2
   /       \/
 [6]      [2]*4</code></pre>
<p>* The Bull in pasture 2 can travel distance 3 (two different ways) to get to the barn then travel distance 2+1 to pastures [3] and [4] to gift his chocolate. That's 6 altogether.</p>
<p>* The Bull in pasture 5 can travel to pasture 4 (distance 3), then pastures 3 and 1 (total: 3 + 2 + 1 = 6) to bestow his chocolate offer.</p>
<p>* The Bull in pasture 3 can travel distance 1 to pasture 1 and then take his chocolate 9 more to pasture 6, a total distance of 10.</p>
<p>Farmer John有B头奶牛(1&lt;=B&lt;=25000)，有N(2*B&lt;=N&lt;=50000)个农场，编号1-N，有M(N-1&lt;=M&lt;=100000)条双向边，第i条边连接农场R_i和S_i(1&lt;=R_i&lt;=N;1&lt;=S_i&lt;=N)，该边的长度是L_i(1&lt;=L_i&lt;=2000)。居住在农场P_i的奶牛A(1&lt;=P_i&lt;=N)，它想送一份新年礼物给居住在农场Q_i(1&lt;=Q_i&lt;=N)的奶牛B，但是奶牛A必须先到FJ(居住在编号1的农场)那里取礼物，然后再送给奶牛B。你的任务是：奶牛A至少需要走多远的路程？</p>
<h2>输入输出格式</h2>
<strong>输入格式：</strong><br>
<p><p>* Line 1: Three space separated integers: N, M, and B</p>
<p>* Lines 2..M+1: Line i+1 describes cowpath i with three</p>
<p>space-separated integers: R_i, S_i, and L_i</p>
<p>* Lines M+2..M+B+1: Line M+i+1 contains two space separated integers: P_i and Q_i</p></p>
<strong>输出格式：</strong><br>
<p><p>* Lines 1..B: Line i should contain a single integer, the smallest distance that the bull in pasture P_i must travel to get chocolates from the barn and then award them to the cow of his dreams in pasture Q_i</p></p>
<h2>输入输出样例</h2>
<div class="am-g">
<div class="am-u-md-6 copy-region">
<strong>输入样例#1：</strong>
<a class="am-badge am-radius lg-bg-orange sample-copy">复制</a>
<pre>6 7 3 
1 2 3 
5 4 3 
3 1 1 
6 1 9 
3 4 2 
1 4 4 
3 2 2 
2 4 
5 1 
3 6 
</pre>
</div>
<div class="am-u-md-6 copy-region">
<strong>输出样例#1：</strong>
<a class="am-badge am-radius lg-bg-orange sample-copy">复制</a>
<pre>6 
6 
10 
</pre>
</div>
</div>
<h2>说明</h2>
<p>输入格式：</p>
<p>第一行：三个用空格隔开的整数N,M和B。</p>
<p>第二到M+1行：第i+1行用R_i，S_i和L_i三个用空格隔开的整数描述双向边i。</p>
<p>第M+2到M+B+1行：第M+i+1行包含两个用空格隔开的整数P_i和Q_i。</p>
<p>输出格式：</p>
<p>第一到B行：第i行包括一个整数，居住在农场P_i的公牛从FJ那里取得情人节巧克力后送给他居住在农场Q_i的梦中情牛至少需要走的距离。</p>
</div>
<div class='lg-article-sub am-g' id="sub"></div>
</div>
</div>
</div>
<div class="am-modal am-modal-prompt" tabindex="-1" id="confirm">
<div class="am-modal-dialog">
<div class="am-modal-hd" id="memtitle">提示</div>
<div class="am-modal-bd" id="memadmin">
标程仅供做题后或实在无思路时参考。<br>
请自觉、自律地使用该功能并请对自己的学习负责。<br>
如果发现恶意抄袭标程，将按照I类违反进行处理。<br>
</div>
<div class="am-modal-footer">
<span class="am-modal-btn" data-am-modal-cancel>取消</span>
<span class="am-modal-btn" data-am-modal-confirm>确定</span>
</div>
</div>
</div>
<script>
        $(document).ready(function () {
            $("#expandstd").click(function () {
                $('#confirm').modal({
                    relatedTarget: this,
                    onConfirm: function (e) {
                        $("#stdcode").slideDown();
                        $("#expandstd").hide();
                    }
                });
            });
            $("#submit").click(
                function () {
                    hide_artile();
                    $(document).scrollTop($(document).scrollTop() - 80);
                    var pid = $(this).attr("pid");
                    $.get("/problem/ajax_submit?pid=" + pid, function (data) {
                        var arr = eval('(' + data + ')');
                        if (arr['code'] == 201) {
                            $('.lg-article-sub').html(arr['more']['html']);
                        }
                        else if (arr['code'] == 200) {

                        }
                        else {
                            if (arr['code'] == 0 || arr['code'] == -3) {
                                backarticle();
                            }
                            show_alert("提交失败", arr['message']);
                        }
                    });
                }
            );
            $("button[title].am-btn,a[title].am-btn").poshytip({
                className: 'tip-twitter',
                showTimeout: 1,
                alignTo: 'target',
                alignX: 'center',
                alignY: 'bottom'
            });
            $('[name=showtag]').click(function () {
                $('.am-badge.am-hide').removeClass('am-hide');
            });
            $(".sample-copy").click(function() {
                var element = $(this).parents(".copy-region").find("pre");
                var text = $(element).text();
                var $temp = $("<textarea>");
                $("body").append($temp);
                $temp.val(text).select();
                document.execCommand("copy");
                $temp.remove();
                $(this).text("复制成功").removeClass("lg-bg-orange");

                var e = this;
                setTimeout(function() {
                    $(e).text("复制").addClass("lg-bg-orange");
                }, 500);
            });
        });
    </script>
</div>
<footer id="app-footer"></footer>
<div class="am-modal am-modal-alert" tabindex="-1" id="lg-alert">
<div class="am-modal-dialog">
<div class="am-modal-hd" id="lg-alert-title"></div>
<div class="am-modal-bd" id="lg-alert-message"></div>
<div class="am-modal-footer">
<span class="am-modal-btn">确定</span>
</div>
</div>
</div>
<script src="/js/ace/ace.js"></script>
<script src="https://cdn.luogu.org/js/vendor.js" data-manual></script>
<script src="https://cdn.luogu.org/js/jsmind.js" data-manual></script>
<script src="https://cdn.luogu.org/js/amazeui.min.js"></script>
<script src="https://cdn.luogu.org/js/highcharts.js"></script>
<script src="https://cdn.luogu.org/js/highcharts-more.js"></script>
<script src="/static/katex/katex.min.js"></script>
<script src="/static/katex/contrib/auto-render.min.js"></script>
<script src="https://cdn.luogu.org/markdown-palettes/markdown-palettes.min.js?ver=20190219"></script>
<script src="https://cdn.luogu.org/js/luogu3.js?ver=20190101"></script>
</body>
</html>
