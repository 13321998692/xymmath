<!DOCTYPE html>
<html class="no-js">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title> P3001 [USACO10DEC]巨无霸Big Macs Around the w… - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1555852692:EDnwUHyYkBzGFYf13WmNwniL8qET+MUXrm+TH+Spuoo=">
<link rel="stylesheet" href="https://cdn.luogu.org/css/amazeui.min.css"/>
<link rel="stylesheet" href="https://cdn.luogu.org/css/katex.min.css"/>
<link rel="stylesheet" href="https://cdn.luogu.org/css/luogu3.css?ver=20190102">
<link rel="stylesheet" href="https://cdn.luogu.org/css/highlight_tomorrow.css">
<link rel="stylesheet" href="https://cdn.luogu.org/markdown-palettes/markdown-palettes.css?ver=20190219">
<script src="https://cdn.luogu.org/js/jquery-2.1.1.min.js"></script>
<script src="https://cdn.luogu.org/js/luogu3_pre.js?ver=20190101"></script>
<link rel="shortcut icon" type="image/x-icon" href="https://cdn.luogu.org/images/favicon3.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.org/fe/loader.css?ver=20190417">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentUser%22%3Anull%2C%22currentTemplate%22%3A%22Excited%22%2C%22currentData%22%3A%7B%22shortHeader%22%3Afalse%2C%22pageName%22%3A%22%5Cu9898%5Cu76ee%5Cu8be6%5Cu60c5%22%7D%2C%22currentMeta%22%3A%7B%22title%22%3A%22%20P3001%20%5BUSACO10DEC%5D%5Cu5de8%5Cu65e0%5Cu9738Big%20Macs%20Around%20the%20w%5Cu2026%22%7D%7D"));</script>
<script>window._release = '20190417';</script>
<script src="https://cdn.luogu.org/fe/loader.js?ver=20190417" charset="utf-8" defer></script>
</head>
<body>
<div id="app-header"></div>
<nav id="app-sidenav"></nav>
<div id="app-body"></div>
<script>
    function scrollToId (id) {
        $('html, body').animate({
            scrollTop: ($('#' + id).offset().top)
        }, 500);
    }
</script>
<style>
    .lg-toolbar {
        display: none;
    }

    #app-body { /* Unused in fallback FE */
        display: none;
    }

    #app-body-new{
        display: block;
        margin-bottom: 2em;
        position: relative;
        box-sizing: border-box;
        max-width: 100%;
    }

    @media (min-width: 576px) {
        #app-body-new {
            margin-left: 70px;
        }
    }

    code {
        font-family: monospace, "Courier New";
    }

</style>
<div id="app-body-new">
<div class="lg-toolbar" data-am-sticky>
<h1><a href="/recordnew/lists?uid=&pid=P3001" target="_blank"><strong class=""><i class="am-icon-minus"></i></strong></a> P3001 [USACO10DEC]巨无霸Big Macs Around the w…</h1>
</div>
<div class="am-g lg-main-content">
<div class="am-u-md-4 lg-right" name="problemright">
<section class="am-panel am-panel-default lg-summary" id="psummary">
<div class="lg-summary-content">
<ul class="am-list am-list-static lg-summary-list">
<li>
<ul class="am-avg-sm-2"><li><span class="lg-bignum-num">34<small></small></span><span class="lg-bignum-text">通过</span></li><li><span class="lg-bignum-num">168<small></small></span><span class="lg-bignum-text">提交</span></li></ul>
</li>
<li>
<strong>题目提供者</strong>
<span class="lg-right"><a class='lg-fg-gray' href="/space/show?uid=20" target="_blank">FarmerJohn2</a></span>
</li>
<li>
<strong>评测方式</strong>
<span class="lg-right"><b>云端评测</b></span>
</li>
<li><strong>标签</strong>
<span class="lg-tag am-badge am-radius lg-bg-bluelight" data-tagid="46">USACO</span>
<span class="lg-tag am-badge am-radius lg-bg-green" data-tagid="27">2010</span>
<span class="lg-tag am-badge am-radius lg-bg-orange" data-tagid="107">Special Judge</span>
<style>.lg-tag { cursor: pointer; }</style>
<script>
                                $(".lg-tag").click(function() {
                                    window.open("/problemnew/lists?tag=" + $(this).attr('data-tagid'));
                                })
                            </script>
</li>
<li><strong>难度</strong>
<span class="lg-right"><span class="am-badge am-radius lg-bg-bluelight">提高+/省选-</span></span>
</li>
<li><strong>时空限制</strong>
<span class="lg-right">1000ms / 128MB</span>
</li>
</ul>
</div>
<p>
<button class="am-btn am-btn-danger am-btn-sm" id="submit" pid="P3001">
<i class="am-icon-paper-plane"></i> 提交
</button>
<a target="_blank" href="/problemnew/solution/P3001" class="am-btn am-btn-primary am-btn-sm">
<i class="am-icon-book"></i> 题解
</a>
<a data-pjax href="/recordnew/lists?pid=P3001" class="am-btn am-btn-primary am-btn-sm" title="查看本题提交记录">
<i class="am-icon-pie-chart"></i>
</a>
<button class="am-btn am-btn-primary am-btn-sm lg-pointer" name="showtag" title="显示算法标签">
<i class="am-icon-tags"></i>
</button>
</p>
<li>提示：收藏到任务计划后，可在首页查看。</li>
<p>
<a class="am-btn am-btn-danger am-btn-sm" href="/fe/problem/P3001" target="_blank">体验新版界面</a>
</p>
</section>
<section class="am-panel am-panel-default lg-summary">
<h2>最新讨论
<a onclick="$('#discuss-lists').show();$(this).hide();" class="am-btn am-btn-primary am-btn-sm lg-right" title="查看本题讨论">
显示
</a>
</h2>
<ul class="am-list am-list-static lg-summary-list" style="display: none" id="discuss-lists">
<li><a data-pjax href="/discuss/show?postid=72048" class="am-padding-0">stm单向汇率</a>
</li>
<li><a data-pjax href="/discuss/show?postid=6167" class="am-padding-0">手写翻译</a>
</li>
<li><a data-pjax href="/discuss/show?postid=6162" class="am-padding-0">略微翻译了一下</a>
</li>
<div style="overflow: auto">
<a data-pjax href="/discuss/lists?forumname=P3001" class="am-btn am-btn-primary am-btn-sm lg-right">进入讨论版</a>
</div>
</ul>
</section>
<section class="am-panel am-panel-default lg-summary am-hide-sm">
<h2>推荐的相关题目
<a onclick="$('#recommendation-list').show();$(this).hide();" class="am-btn am-btn-primary am-btn-sm lg-right" title="查看推荐题目">
显示
</a>
</h2>
<ul class="am-list am-list-static lg-summary-list" id="recommendation-list" style="display: none">
<li>
<a class='colored' href="/problemnew/show/P2498" target="_blank"><b>P2498</b> [SDOI2012]拯救小云公主</a>
</li>
<li>
<a class='colored' href="/problemnew/show/P3385" target="_blank"><b>P3385</b> 【模板】负环</a>
</li>
<li>
<a class='colored' href="/problemnew/show/P3017" target="_blank"><b>P3017</b> [USACO11MAR]布朗尼切片Brownie Slicing</a>
</li>
<li>
<a class='colored' href="/problemnew/show/P2901" target="_blank"><b>P2901</b> [USACO08MAR]牛慢跑Cow Jogging</a>
</li>
<li>
<a class='colored' href="/problemnew/show/P3015" target="_blank"><b>P3015</b> [USACO11FEB]最好的括号Best Parenthesis</a>
</li>
</ul>
</section>
</div>
<div class="am-u-md-8 lg-right" name="problemleft">
<div class="lg-content-left">
<div class="lg-article am-g">
<h2>题目背景</h2>
<p>Bessie正在学习她最喜欢的科目宏观经济学，作为她最后一门学科，她将对世界各种货币的汇率进行研究。</p>
<h2>题目描述</h2>
<p>Bessie is studying her favorite subject, Macroeconomics, in cowllege. For her final project, she will be presenting research on exchange rates between countries around the world.</p>
<p>In order to make her presentation more lively, she would like to show the relative prices of Big Macs around the world, despite their rather unsavory contents. To illustrate, suppose that Bessie would like to find smallest value of a Big Mac in a country given its value in some initial country and exchange rates from which other country's values can be calculated (as illustrated below):</p>
<pre><code class="language-cpp">* A Big Mac is worth 60 dollars in the United States 
* The exchange rate from US dollars to Canadian dollars is 0.2 Canadian dollars per US dollar 
* The exchange rate from US dollars to British Pounds is 5.00 British Pounds per US Dollar 
* The exchange rate from British Pounds to Canadian dollars is 0.5 Canadian dollars per British Pound 
* The exchange rate between Canadian dollars to US dollars is 5.00 US dollars per Canadian dollar and Bessie would like to find the smallest possible value of a Big Mac in Canada that can be obtained by exchanging currencies. There are two ways: 
* Going from US dollars directly to Canada dollars would yield a burger worth 60.00 US dollars * 0.2 Canadian dollars / US dollar = 12.00 Canadian dollars 
* Going from US dollars to British Pounds to Canadian dollars would yield a burger worth 60.00 US$ * 5.00 GBP / 1 US$ * 0.5 C$ / 1 GBP = 150.00 C$ (Canadian dollars). 
Bessie would choose the former option, since she would much rather pay 12.00 Canadian dollars instead of 150.00 Canadian dollars for a Big Mac in Canada. 
Bessie has N (1 &lt;= N &lt;= 2,000) countries conveniently labeled 1 to N that she would like to consider along with a list of M (1 &lt;= M &lt;= 25,000) exchange rates e_ij (0.1 &lt; e_ij &lt;= 10), each between countries i and j (1 &lt;= i &lt;= N; 1 &lt;= j &lt;= N). 
Given the value V (1 &lt;= V &lt;= 1,000,000,000,000), which is not 
necessarily an integer, of the Big Mac in her starting country A (1 &lt;= A &lt;= N), help her find the smallest possible value of a Big Mac in country B (1 &lt;= B &lt;= N; B != A) after a series of currency conversions. If there is no minimum, output 0. </code></pre>
<p>It is guaranteed that the answer is, if not 0, between 1 and 10^15.
It is also guaranteed that, for any country's currency, it is</p>
<p>possible to get to any other country's currency.</p>
<p>为了让她的演讲更加生动，她会展示一个叫做“BM”的商品在全世界的相对价格。举个例子，Bessie会通过其他国家的汇率去找到一件BM在一个国家的最小价值（如下所示）</p>
<p>一件BM在美国值60美元；</p>
<p>美元与加拿大元的汇率为一美元换0.2加拿大元（1：0.2）</p>
<p>美元与英镑的汇率为一美元换五英镑（1：5）</p>
<p>英镑与加拿大元的汇率为一英镑换0.5加拿大元（1：0.5）</p>
<p>加拿大元与美元的汇率是五美元换一加拿大元（5：1[通过上面的可以换算得出]），Bessis有两种方法通过货币兑换在加拿大这个国家找到一件BM的最低价值：</p>
<p>一：拿着美元直接去加拿大，通过汇率得出一件BM只要十二加拿大元</p>
<p>二：拿着美元去英国，兑换为英镑后再去加拿大，得出一件BM要一百五十加拿大元</p>
<p>（由于长度，剩下…</p>
<h2>输入输出格式</h2>
<strong>输入格式：</strong><br>
<p><p>（续）</p>
<p>Bessie会选择前一种方案因为她更乐意为在加拿大买一件BM支付十二加元而不是一百五十加元。</p>
<p>Bessie有N(1&lt;=N&lt;=2000)个国家的信息和M种汇率(1&lt;=M&lt;=25000)，在i，j国间的汇率表示为e_ij(0.1&lt;=e_ij&lt;=10)。</p>
<p>给你一个值V(1&lt;=V&lt;=1000000000000),但V不一定是一个整数。V是BM在Bessie起始国家A的价格，帮助她寻找到在B国BM最低的价格，如果不存在，则输出0。</p>
<p>数据保证答案小于十的十五次方，也保证所有国家都可以通过汇率将钱币转为别的国家的。</p>
<p>* Line 1: Five space-separated numbers: N, M, V, A, B</p>
<p>* Lines 2..M+1: Three space-separated numbers: i, j, e_ij</p>
<p>第一行：五个数：N,M,V,A,B 分别一个空格隔开</p>
<p>第2到M+1行：三个数i,j,e_ij 分别一个空格隔开</p></p>
<strong>输出格式：</strong><br>
<p><p>* Line 1: A single positive number, the price of the Big Mac, with absolute or relative error at most 10^-6. If there is no minimum, output 0.</p>
<p>一行：BM在B国的最低价格，精确到10^-6。如果没有最小值，输出0</p></p>
<h2>输入输出样例</h2>
<div class="am-g">
<div class="am-u-md-6 copy-region">
<strong>输入样例#1：</strong>
<a class="am-badge am-radius lg-bg-orange sample-copy">复制</a>
<pre>3 4 60 1 2 
1 2 0.2 
1 3 5 
3 2 0.5 
2 1 5 
</pre>
</div>
<div class="am-u-md-6 copy-region">
<strong>输出样例#1：</strong>
<a class="am-badge am-radius lg-bg-orange sample-copy">复制</a>
<pre>12.00 
</pre>
</div>
</div>
<h2>说明</h2>
<p><strong>注意 这里的汇率是单向的</strong></p>
<p>感谢@JJYZ_cbh 的耐心翻译</p>
</div>
<div class='lg-article-sub am-g' id="sub"></div>
</div>
</div>
</div>
<div class="am-modal am-modal-prompt" tabindex="-1" id="confirm">
<div class="am-modal-dialog">
<div class="am-modal-hd" id="memtitle">提示</div>
<div class="am-modal-bd" id="memadmin">
标程仅供做题后或实在无思路时参考。<br>
请自觉、自律地使用该功能并请对自己的学习负责。<br>
如果发现恶意抄袭标程，将按照I类违反进行处理。<br>
</div>
<div class="am-modal-footer">
<span class="am-modal-btn" data-am-modal-cancel>取消</span>
<span class="am-modal-btn" data-am-modal-confirm>确定</span>
</div>
</div>
</div>
<script>
        $(document).ready(function () {
            $("#expandstd").click(function () {
                $('#confirm').modal({
                    relatedTarget: this,
                    onConfirm: function (e) {
                        $("#stdcode").slideDown();
                        $("#expandstd").hide();
                    }
                });
            });
            $("#submit").click(
                function () {
                    hide_artile();
                    $(document).scrollTop($(document).scrollTop() - 80);
                    var pid = $(this).attr("pid");
                    $.get("/problem/ajax_submit?pid=" + pid, function (data) {
                        var arr = eval('(' + data + ')');
                        if (arr['code'] == 201) {
                            $('.lg-article-sub').html(arr['more']['html']);
                        }
                        else if (arr['code'] == 200) {

                        }
                        else {
                            if (arr['code'] == 0 || arr['code'] == -3) {
                                backarticle();
                            }
                            show_alert("提交失败", arr['message']);
                        }
                    });
                }
            );
            $("button[title].am-btn,a[title].am-btn").poshytip({
                className: 'tip-twitter',
                showTimeout: 1,
                alignTo: 'target',
                alignX: 'center',
                alignY: 'bottom'
            });
            $('[name=showtag]').click(function () {
                $('.am-badge.am-hide').removeClass('am-hide');
            });
            $(".sample-copy").click(function() {
                var element = $(this).parents(".copy-region").find("pre");
                var text = $(element).text();
                var $temp = $("<textarea>");
                $("body").append($temp);
                $temp.val(text).select();
                document.execCommand("copy");
                $temp.remove();
                $(this).text("复制成功").removeClass("lg-bg-orange");

                var e = this;
                setTimeout(function() {
                    $(e).text("复制").addClass("lg-bg-orange");
                }, 500);
            });
        });
    </script>
</div>
<footer id="app-footer"></footer>
<div class="am-modal am-modal-alert" tabindex="-1" id="lg-alert">
<div class="am-modal-dialog">
<div class="am-modal-hd" id="lg-alert-title"></div>
<div class="am-modal-bd" id="lg-alert-message"></div>
<div class="am-modal-footer">
<span class="am-modal-btn">确定</span>
</div>
</div>
</div>
<script src="/js/ace/ace.js"></script>
<script src="https://cdn.luogu.org/js/vendor.js" data-manual></script>
<script src="https://cdn.luogu.org/js/jsmind.js" data-manual></script>
<script src="https://cdn.luogu.org/js/amazeui.min.js"></script>
<script src="https://cdn.luogu.org/js/highcharts.js"></script>
<script src="https://cdn.luogu.org/js/highcharts-more.js"></script>
<script src="/static/katex/katex.min.js"></script>
<script src="/static/katex/contrib/auto-render.min.js"></script>
<script src="https://cdn.luogu.org/markdown-palettes/markdown-palettes.min.js?ver=20190219"></script>
<script src="https://cdn.luogu.org/js/luogu3.js?ver=20190101"></script>
</body>
</html>
