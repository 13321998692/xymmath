<!DOCTYPE html>
<html class="no-js">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title> P3141 [USACO16FEB]围栏Fenced In_Platinum - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1555852758:lxvRCyhrdYJFf+PMOoCl/j51FCVNKgAMGeFI5Rbamc8=">
<link rel="stylesheet" href="https://cdn.luogu.org/css/amazeui.min.css"/>
<link rel="stylesheet" href="https://cdn.luogu.org/css/katex.min.css"/>
<link rel="stylesheet" href="https://cdn.luogu.org/css/luogu3.css?ver=20190102">
<link rel="stylesheet" href="https://cdn.luogu.org/css/highlight_tomorrow.css">
<link rel="stylesheet" href="https://cdn.luogu.org/markdown-palettes/markdown-palettes.css?ver=20190219">
<script src="https://cdn.luogu.org/js/jquery-2.1.1.min.js"></script>
<script src="https://cdn.luogu.org/js/luogu3_pre.js?ver=20190101"></script>
<link rel="shortcut icon" type="image/x-icon" href="https://cdn.luogu.org/images/favicon3.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.org/fe/loader.css?ver=20190417">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentUser%22%3Anull%2C%22currentTemplate%22%3A%22Excited%22%2C%22currentData%22%3A%7B%22shortHeader%22%3Afalse%2C%22pageName%22%3A%22%5Cu9898%5Cu76ee%5Cu8be6%5Cu60c5%22%7D%2C%22currentMeta%22%3A%7B%22title%22%3A%22%20P3141%20%5BUSACO16FEB%5D%5Cu56f4%5Cu680fFenced%20In_Platinum%22%7D%7D"));</script>
<script>window._release = '20190417';</script>
<script src="https://cdn.luogu.org/fe/loader.js?ver=20190417" charset="utf-8" defer></script>
</head>
<body>
<div id="app-header"></div>
<nav id="app-sidenav"></nav>
<div id="app-body"></div>
<script>
    function scrollToId (id) {
        $('html, body').animate({
            scrollTop: ($('#' + id).offset().top)
        }, 500);
    }
</script>
<style>
    .lg-toolbar {
        display: none;
    }

    #app-body { /* Unused in fallback FE */
        display: none;
    }

    #app-body-new{
        display: block;
        margin-bottom: 2em;
        position: relative;
        box-sizing: border-box;
        max-width: 100%;
    }

    @media (min-width: 576px) {
        #app-body-new {
            margin-left: 70px;
        }
    }

    code {
        font-family: monospace, "Courier New";
    }

</style>
<div id="app-body-new">
<div class="lg-toolbar" data-am-sticky>
<h1><a href="/recordnew/lists?uid=&pid=P3141" target="_blank"><strong class=""><i class="am-icon-minus"></i></strong></a> P3141 [USACO16FEB]围栏Fenced In_Platinum</h1>
</div>
<div class="am-g lg-main-content">
<div class="am-u-md-4 lg-right" name="problemright">
<section class="am-panel am-panel-default lg-summary" id="psummary">
<div class="lg-summary-content">
<ul class="am-list am-list-static lg-summary-list">
<li>
<ul class="am-avg-sm-2"><li><span class="lg-bignum-num">92<small></small></span><span class="lg-bignum-text">通过</span></li><li><span class="lg-bignum-num">245<small></small></span><span class="lg-bignum-text">提交</span></li></ul>
</li>
<li>
<strong>题目提供者</strong>
<span class="lg-right"><a class='lg-fg-gray' href="/space/show?uid=20" target="_blank">FarmerJohn2</a></span>
</li>
<li>
<strong>评测方式</strong>
<span class="lg-right"><b>云端评测</b></span>
</li>
<li><strong>标签</strong>
<span class="lg-tag am-badge am-radius lg-bg-pink am-hide" data-tagid="3">动态规划,动规,dp</span>
<span class="lg-tag am-badge am-radius lg-bg-pink am-hide" data-tagid="111">枚举,暴力</span>
<span class="lg-tag am-badge am-radius lg-bg-pink am-hide" data-tagid="42">线段树</span>
<span class="lg-tag am-badge am-radius lg-bg-bluelight" data-tagid="46">USACO</span>
<span class="lg-tag am-badge am-radius lg-bg-green" data-tagid="33">2016</span>
<style>.lg-tag { cursor: pointer; }</style>
<script>
                                $(".lg-tag").click(function() {
                                    window.open("/problemnew/lists?tag=" + $(this).attr('data-tagid'));
                                })
                            </script>
</li>
<li><strong>难度</strong>
<span class="lg-right"><span class="am-badge am-radius lg-bg-bluelight">提高+/省选-</span></span>
</li>
<li><strong>时空限制</strong>
<span class="lg-right">1000ms / 128MB</span>
</li>
</ul>
</div>
<p>
<button class="am-btn am-btn-danger am-btn-sm" id="submit" pid="P3141">
<i class="am-icon-paper-plane"></i> 提交
</button>
<a target="_blank" href="/problemnew/solution/P3141" class="am-btn am-btn-primary am-btn-sm">
<i class="am-icon-book"></i> 题解
</a>
<a data-pjax href="/recordnew/lists?pid=P3141" class="am-btn am-btn-primary am-btn-sm" title="查看本题提交记录">
<i class="am-icon-pie-chart"></i>
</a>
<button class="am-btn am-btn-primary am-btn-sm lg-pointer" name="showtag" title="显示算法标签">
<i class="am-icon-tags"></i>
</button>
</p>
<li>提示：收藏到任务计划后，可在首页查看。</li>
<p>
<a class="am-btn am-btn-danger am-btn-sm" href="/fe/problem/P3141" target="_blank">体验新版界面</a>
</p>
</section>
<section class="am-panel am-panel-default lg-summary">
<h2>最新讨论
<a onclick="$('#discuss-lists').show();$(this).hide();" class="am-btn am-btn-primary am-btn-sm lg-right" title="查看本题讨论">
显示
</a>
</h2>
<ul class="am-list am-list-static lg-summary-list" style="display: none" id="discuss-lists">
<li>暂时没有讨论</li>
<div style="overflow: auto">
<a data-pjax href="/discuss/lists?forumname=P3141" class="am-btn am-btn-primary am-btn-sm lg-right">进入讨论版</a>
</div>
</ul>
</section>
<section class="am-panel am-panel-default lg-summary am-hide-sm">
<h2>推荐的相关题目
<a onclick="$('#recommendation-list').show();$(this).hide();" class="am-btn am-btn-primary am-btn-sm lg-right" title="查看推荐题目">
显示
</a>
</h2>
<ul class="am-list am-list-static lg-summary-list" id="recommendation-list" style="display: none">
<li>
<a class='colored' href="/problemnew/show/P3377" target="_blank"><b>P3377</b> 【模板】左偏树（可并堆）</a>
</li>
<li>
<a class='colored' href="/problemnew/show/P3147" target="_blank"><b>P3147</b> [USACO16OPEN]262144</a>
</li>
<li>
<a class='colored' href="/problemnew/show/P4825" target="_blank"><b>P4825</b> [USACO15FEB]Cow Hopscotch (Silver) 牛跳房子(银)</a>
</li>
<li>
<a class='colored' href="/problemnew/show/P3007" target="_blank"><b>P3007</b> [USACO11JAN]大陆议会The Continental Cowngress</a>
</li>
<li>
<a class='colored' href="/problemnew/show/P2704" target="_blank"><b>P2704</b> [NOI2001]炮兵阵地</a>
</li>
</ul>
</section>
</div>
<div class="am-u-md-8 lg-right" name="problemleft">
<div class="lg-content-left">
<div class="lg-article am-g">
<h2>题目描述</h2>
<p>Farmer John has realized that many of his cows are strangely agoraphobic (being fearful of large open spaces). To try and make them less afraid of grazing, he partitions his large field into a number of smaller regions by building vertical (north-south) and horizontal (east-west) fences.</p>
<p>The large field is a rectangle with corner points at $(0,0)$ and $(A,B)$. FJ builds $n$ vertical fences ($0 \leq n \leq 25,000$) at distinct locations $a_1 \ldots a_n$ ($0 &lt; a_i &lt; A$); each fence runs from $(a_i, 0)$ to $(a_i, B)$. He also builds $m$ horizontal fences ($0 \leq m \leq 25,000$) at locations $b_1 \ldots b_m$ ($0 &lt; b_i &lt; B$); each such fence runs from $(0, b_i)$ to $(A, b_i)$. Each vertical fence crosses through each horizontal fence, subdividing the large field into a total of $(n+1)(m+1)$ regions.</p>
<p>Unfortunately, FJ completely forgot to build gates into his fences, making it impossible for cows to leave their enclosing region and travel around the entire field! He wants to remedy this situation by removing pieces of some of his fences to allow cows to travel between adjacent regions. He wants to select certain pairs of adjacent regions and remove the entire length of fence separating them; afterwards, he wants cows to be able to wander through these openings so they can travel anywhere in his larger field.</p>
<p>For example, FJ might take a fence pattern looking like this:</p>
<pre><code class="language-cpp">+---+--+
|   |  |
+---+--+
|   |  |  
|   |  |
+---+--+</code></pre>
<p>and open it up like so:</p>
<pre><code class="language-cpp">+---+--+
|      |  
+---+  +  
|      |  
|      |
+---+--+</code></pre>
<p>Please help FJ determine the minimum total length of fencing he must remove to accomplish his goal.</p>
<p>有一个平面，左下角是(0,0)，右上角是(A,B)。</p>
<p>有n个平行于y轴的栅栏a1..an，表示挡在(ai,0)到(ai,B)之间。</p>
<p>有m个平行于x轴的栅栏b1..bn，表示挡在(0,bi)到(A,bi)之间。</p>
<p>这样，平面被划成了(n+1)*(m+1)块。</p>
<p>现在要去掉某些栅栏的一部分，使得每一块都连通。</p>
<p>比如原来是这样：</p>
<p>+---+--+</p>
<p>| | |
+---+--+</p>
<table>
<thead>
<tr>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
</tbody>
</table>
<p>+---+--+</p>
<p>可以去掉后变成这样：</p>
<p>+---+--+</p>
<p>| |<br />
+---+ +</p>
<table>
<thead>
<tr>
<th></th>
</tr>
</thead>
<tbody>
</tbody>
</table>
<p>+---+--+</p>
<p>求最少需要去掉多少长度的栅栏使得每一块都连通。</p>
<h2>输入输出格式</h2>
<strong>输入格式：</strong><br>
<p><p>The first line of input contains $A$, $B$, $n$, and $m$</p>
<p>($1 \leq A, B \leq 1,000,000,000$). The next $n$ lines contain $a_1 \ldots a_n$,</p>
<p>and the next $m$ lines after that contain $b_1 \ldots b_m$.</p></p>
<strong>输出格式：</strong><br>
<p><p>Please write the minimum length of fencing FJ must remove. Note that this might</p>
<p>be too large to fit into a standard 32-bit integer, so you may need to</p>
<p>use 64-bit integer types (e.g., &quot;long long&quot; in C/C++).</p></p>
<h2>输入输出样例</h2>
<div class="am-g">
<div class="am-u-md-6 copy-region">
<strong>输入样例#1：</strong>
<a class="am-badge am-radius lg-bg-orange sample-copy">复制</a>
<pre>15 15 5 2
2
5
10
6
4
11
3</pre>
</div>
<div class="am-u-md-6 copy-region">
<strong>输出样例#1：</strong>
<a class="am-badge am-radius lg-bg-orange sample-copy">复制</a>
<pre>44</pre>
</div>
</div>
</div>
<div class='lg-article-sub am-g' id="sub"></div>
</div>
</div>
</div>
<div class="am-modal am-modal-prompt" tabindex="-1" id="confirm">
<div class="am-modal-dialog">
<div class="am-modal-hd" id="memtitle">提示</div>
<div class="am-modal-bd" id="memadmin">
标程仅供做题后或实在无思路时参考。<br>
请自觉、自律地使用该功能并请对自己的学习负责。<br>
如果发现恶意抄袭标程，将按照I类违反进行处理。<br>
</div>
<div class="am-modal-footer">
<span class="am-modal-btn" data-am-modal-cancel>取消</span>
<span class="am-modal-btn" data-am-modal-confirm>确定</span>
</div>
</div>
</div>
<script>
        $(document).ready(function () {
            $("#expandstd").click(function () {
                $('#confirm').modal({
                    relatedTarget: this,
                    onConfirm: function (e) {
                        $("#stdcode").slideDown();
                        $("#expandstd").hide();
                    }
                });
            });
            $("#submit").click(
                function () {
                    hide_artile();
                    $(document).scrollTop($(document).scrollTop() - 80);
                    var pid = $(this).attr("pid");
                    $.get("/problem/ajax_submit?pid=" + pid, function (data) {
                        var arr = eval('(' + data + ')');
                        if (arr['code'] == 201) {
                            $('.lg-article-sub').html(arr['more']['html']);
                        }
                        else if (arr['code'] == 200) {

                        }
                        else {
                            if (arr['code'] == 0 || arr['code'] == -3) {
                                backarticle();
                            }
                            show_alert("提交失败", arr['message']);
                        }
                    });
                }
            );
            $("button[title].am-btn,a[title].am-btn").poshytip({
                className: 'tip-twitter',
                showTimeout: 1,
                alignTo: 'target',
                alignX: 'center',
                alignY: 'bottom'
            });
            $('[name=showtag]').click(function () {
                $('.am-badge.am-hide').removeClass('am-hide');
            });
            $(".sample-copy").click(function() {
                var element = $(this).parents(".copy-region").find("pre");
                var text = $(element).text();
                var $temp = $("<textarea>");
                $("body").append($temp);
                $temp.val(text).select();
                document.execCommand("copy");
                $temp.remove();
                $(this).text("复制成功").removeClass("lg-bg-orange");

                var e = this;
                setTimeout(function() {
                    $(e).text("复制").addClass("lg-bg-orange");
                }, 500);
            });
        });
    </script>
</div>
<footer id="app-footer"></footer>
<div class="am-modal am-modal-alert" tabindex="-1" id="lg-alert">
<div class="am-modal-dialog">
<div class="am-modal-hd" id="lg-alert-title"></div>
<div class="am-modal-bd" id="lg-alert-message"></div>
<div class="am-modal-footer">
<span class="am-modal-btn">确定</span>
</div>
</div>
</div>
<script src="/js/ace/ace.js"></script>
<script src="https://cdn.luogu.org/js/vendor.js" data-manual></script>
<script src="https://cdn.luogu.org/js/jsmind.js" data-manual></script>
<script src="https://cdn.luogu.org/js/amazeui.min.js"></script>
<script src="https://cdn.luogu.org/js/highcharts.js"></script>
<script src="https://cdn.luogu.org/js/highcharts-more.js"></script>
<script src="/static/katex/katex.min.js"></script>
<script src="/static/katex/contrib/auto-render.min.js"></script>
<script src="https://cdn.luogu.org/markdown-palettes/markdown-palettes.min.js?ver=20190219"></script>
<script src="https://cdn.luogu.org/js/luogu3.js?ver=20190101"></script>
</body>
</html>
