<!DOCTYPE html>
<html class="no-js">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title> P4818 [USACO15DEC]Bessie&#039;s Dream 贝西的梦 - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1555853466:4wdnPrisNFR5za6OmtkUopd5M/09G8+8zyV3kOb+y/s=">
<link rel="stylesheet" href="https://cdn.luogu.org/css/amazeui.min.css"/>
<link rel="stylesheet" href="https://cdn.luogu.org/css/katex.min.css"/>
<link rel="stylesheet" href="https://cdn.luogu.org/css/luogu3.css?ver=20190102">
<link rel="stylesheet" href="https://cdn.luogu.org/css/highlight_tomorrow.css">
<link rel="stylesheet" href="https://cdn.luogu.org/markdown-palettes/markdown-palettes.css?ver=20190219">
<script src="https://cdn.luogu.org/js/jquery-2.1.1.min.js"></script>
<script src="https://cdn.luogu.org/js/luogu3_pre.js?ver=20190101"></script>
<link rel="shortcut icon" type="image/x-icon" href="https://cdn.luogu.org/images/favicon3.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.org/fe/loader.css?ver=20190417">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentUser%22%3Anull%2C%22currentTemplate%22%3A%22Excited%22%2C%22currentData%22%3A%7B%22shortHeader%22%3Afalse%2C%22pageName%22%3A%22%5Cu9898%5Cu76ee%5Cu8be6%5Cu60c5%22%7D%2C%22currentMeta%22%3A%7B%22title%22%3A%22%20P4818%20%5BUSACO15DEC%5DBessie%27s%20Dream%20%5Cu8d1d%5Cu897f%5Cu7684%5Cu68a6%22%7D%7D"));</script>
<script>window._release = '20190417';</script>
<script src="https://cdn.luogu.org/fe/loader.js?ver=20190417" charset="utf-8" defer></script>
</head>
<body>
<div id="app-header"></div>
<nav id="app-sidenav"></nav>
<div id="app-body"></div>
<script>
    function scrollToId (id) {
        $('html, body').animate({
            scrollTop: ($('#' + id).offset().top)
        }, 500);
    }
</script>
<style>
    .lg-toolbar {
        display: none;
    }

    #app-body { /* Unused in fallback FE */
        display: none;
    }

    #app-body-new{
        display: block;
        margin-bottom: 2em;
        position: relative;
        box-sizing: border-box;
        max-width: 100%;
    }

    @media (min-width: 576px) {
        #app-body-new {
            margin-left: 70px;
        }
    }

    code {
        font-family: monospace, "Courier New";
    }

</style>
<div id="app-body-new">
<div class="lg-toolbar" data-am-sticky>
<h1><a href="/recordnew/lists?uid=&pid=P4818" target="_blank"><strong class=""><i class="am-icon-minus"></i></strong></a> P4818 [USACO15DEC]Bessie&#039;s Dream 贝西的梦</h1>
</div>
<div class="am-g lg-main-content">
<div class="am-u-md-4 lg-right" name="problemright">
<section class="am-panel am-panel-default lg-summary" id="psummary">
<div class="lg-summary-content">
<ul class="am-list am-list-static lg-summary-list">
<li>
<ul class="am-avg-sm-2"><li><span class="lg-bignum-num">47<small></small></span><span class="lg-bignum-text">通过</span></li><li><span class="lg-bignum-num">284<small></small></span><span class="lg-bignum-text">提交</span></li></ul>
</li>
<li>
<strong>题目提供者</strong>
<span class="lg-right"><a class='lg-fg-green' href="/space/show?uid=57705" target="_blank">俺是小程</a></span>
</li>
<li>
<strong>评测方式</strong>
<span class="lg-right"><b>云端评测</b></span>
</li>
<li><strong>标签</strong>
<span class="lg-tag am-badge am-radius lg-bg-pink am-hide" data-tagid="244">进制</span>
<span class="lg-tag am-badge am-radius lg-bg-bluelight" data-tagid="46">USACO</span>
<span class="lg-tag am-badge am-radius lg-bg-green" data-tagid="32">2015</span>
<style>.lg-tag { cursor: pointer; }</style>
<script>
                                $(".lg-tag").click(function() {
                                    window.open("/problemnew/lists?tag=" + $(this).attr('data-tagid'));
                                })
                            </script>
</li>
<li><strong>难度</strong>
<span class="lg-right"><span class="am-badge am-radius lg-bg-bluelight">提高+/省选-</span></span>
</li>
<li><strong>时空限制</strong>
<span class="lg-right">1000ms / 128MB</span>
</li>
</ul>
</div>
<p>
<button class="am-btn am-btn-danger am-btn-sm" id="submit" pid="P4818">
<i class="am-icon-paper-plane"></i> 提交
</button>
<a target="_blank" href="/problemnew/solution/P4818" class="am-btn am-btn-primary am-btn-sm">
<i class="am-icon-book"></i> 题解
</a>
<a data-pjax href="/recordnew/lists?pid=P4818" class="am-btn am-btn-primary am-btn-sm" title="查看本题提交记录">
<i class="am-icon-pie-chart"></i>
</a>
<button class="am-btn am-btn-primary am-btn-sm lg-pointer" name="showtag" title="显示算法标签">
<i class="am-icon-tags"></i>
</button>
</p>
<li>提示：收藏到任务计划后，可在首页查看。</li>
<p>
<a class="am-btn am-btn-danger am-btn-sm" href="/fe/problem/P4818" target="_blank">体验新版界面</a>
</p>
</section>
<section class="am-panel am-panel-default lg-summary">
<h2>最新讨论
<a onclick="$('#discuss-lists').show();$(this).hide();" class="am-btn am-btn-primary am-btn-sm lg-right" title="查看本题讨论">
显示
</a>
</h2>
<ul class="am-list am-list-static lg-summary-list" style="display: none" id="discuss-lists">
<li><a data-pjax href="/discuss/show?postid=102873" class="am-padding-0">UNDERTALE彩砖谜题？！？</a>
</li>
<li><a data-pjax href="/discuss/show?postid=59353" class="am-padding-0">翻译</a>
</li>
<li><a data-pjax href="/discuss/show?postid=59342" class="am-padding-0">蒟蒻问个问题</a>
</li>
<div style="overflow: auto">
<a data-pjax href="/discuss/lists?forumname=P4818" class="am-btn am-btn-primary am-btn-sm lg-right">进入讨论版</a>
</div>
</ul>
</section>
<section class="am-panel am-panel-default lg-summary am-hide-sm">
<h2>推荐的相关题目
<a onclick="$('#recommendation-list').show();$(this).hide();" class="am-btn am-btn-primary am-btn-sm lg-right" title="查看推荐题目">
显示
</a>
</h2>
<ul class="am-list am-list-static lg-summary-list" id="recommendation-list" style="display: none">
<li>
<a class='colored' href="/problemnew/show/P3132" target="_blank"><b>P3132</b> [USACO16JAN]愤怒的奶牛Angry Cows</a>
</li>
<li>
<a class='colored' href="/problemnew/show/P3128" target="_blank"><b>P3128</b> [USACO15DEC]最大流Max Flow</a>
</li>
<li>
<a class='colored' href="/problemnew/show/P4374" target="_blank"><b>P4374</b> [USACO18OPEN]Disruption</a>
</li>
<li>
<a class='colored' href="/problemnew/show/P2324" target="_blank"><b>P2324</b> [SCOI2005]骑士精神</a>
</li>
<li>
<a class='colored' href="/problemnew/show/P3373" target="_blank"><b>P3373</b> 【模板】线段树 2</a>
</li>
</ul>
</section>
</div>
<div class="am-u-md-8 lg-right" name="problemleft">
<div class="lg-content-left">
<div class="lg-article am-g">
<h2>题意翻译</h2>
<p>有一个 $N\times M$ 的棋盘，Bessie 开始时在左上角的格子，她要移动到右下角的格子上。当 Bessie 位于一个格子上时，她只能移动到与之有公共边的相邻格子。棋盘上的格子按照颜色可分为红、粉、橙、绿、紫五类。</p>
<ul>
<li>红色格子：不能通过。</li>
<li>粉色格子：可以自由通过。</li>
<li>橙色格子：可以自由通过，但 Bessie 通过橙色格子后会沾上橙子味。</li>
<li>绿色格子：当且仅当 Bessie 身上有橙子味时，Bessie才能通过绿色格子。</li>
<li>紫色格子：Bessie 会在上面漂移（除非她漂移的方向上有一个不能通过的格子），并且 Bessie 身上的橙子味会消失。举个例子，如果 Bessie 从紫色格子左边的格子移动到紫色格子上，
<ul>
<li>如果右边是粉/橙色格子：Bessie 会滑到右边。</li>
<li>如果右边是红/绿色格子，或者右边是边界：Bessie 会停在当前紫色格子上。</li>
<li>如果右边仍然是紫色格子：Bessie 会滑到右边，然后继续根据这一规定来漂移。</li>
</ul></li>
</ul>
<p>请问 Bessie 最少需要移动多少步。</p>
<p>Translated by @Planet6174 </p>
<h2>题目描述</h2>
<p>After eating too much fruit in Farmer John's kitchen, Bessie the cow is getting some very strange dreams! In her most recent dream, she is trapped in a maze in the shape of an $N×M$ grid of tiles $(1≤N,M≤1,000)$. She starts on the top-left tile and wants to get to the bottom-right tile. When she is standing on a tile, she can potentially move to the adjacent tiles in any of the four cardinal directions.</p>
<p>But wait! Each tile has a color, and each color has a different property! Bessie's head hurts just thinking about it:</p>
<ul>
<li>
<p>If a tile is <strong>red</strong>, then it is impassable.</p>
</li>
<li>
<p>If a tile is <strong>pink</strong>, then it can be walked on normally.</p>
</li>
<li>
<p>If a tile is <strong>orange</strong>, then it can be walked on normally, but will make Bessie smell like oranges.</p>
</li>
<li>
<p>If a tile is <strong>blue</strong>, then it contains piranhas that will only let Bessie pass if she smells like oranges.</p>
</li>
<li>
<p>If a tile is <strong>purple</strong>, then Bessie will slide to the next tile in that direction (unless she is unable to cross it). If this tile is also a purple tile, then Bessie will continue to slide until she lands on a non-purple tile or hits an impassable tile. Sliding through a tile counts as a move. <strong>Purple tiles will also remove Bessie's smell.</strong></p>
</li>
</ul>
<p>(If you're confused about purple tiles, the example will illustrate their use.)</p>
<p>Please help Bessie get from the top-left to the bottom-right in as few moves as possible. </p>
<h2>输入输出格式</h2>
<strong>输入格式：</strong><br>
<p><p>The first line has two integers $N$ and $M$, representing the number of rows and columns of the maze.</p>
<p>The next $N$ lines have $M$ integers each, representing the maze:</p>
<ul>
<li>
<p>The integer '0' is a red tile</p>
</li>
<li>
<p>The integer '1' is a pink tile</p>
</li>
<li>
<p>The integer '2' is an orange tile</p>
</li>
<li>
<p>The integer '3' is a blue tile</p>
</li>
<li>
<p>The integer '4' is a purple tile </p>
</li>
</ul>
<p>The top-left and bottom-right integers will always be '1'. </p></p>
<strong>输出格式：</strong><br>
<p><p>A single integer, representing the minimum number of moves Bessie must use to cross the maze, or -1 if it is impossible to do so. </p></p>
<h2>输入输出样例</h2>
<div class="am-g">
<div class="am-u-md-6 copy-region">
<strong>输入样例#1：</strong>
<a class="am-badge am-radius lg-bg-orange sample-copy">复制</a>
<pre>4 4
1 0 2 1
1 1 4 1
1 0 4 0
1 3 1 1</pre>
</div>
<div class="am-u-md-6 copy-region">
<strong>输出样例#1：</strong>
<a class="am-badge am-radius lg-bg-orange sample-copy">复制</a>
<pre>10</pre>
</div>
</div>
<h2>说明</h2>
<p>In this example, Bessie walks one square down and two squares to the right (and then slides one more square to the right). She walks one square up, one square left, and one square down (sliding two more squares down) and finishes by walking one more square right. This is a total of 10 moves (DRRRULDDDR).</p>
<p>Problem credits: Nathan Pinsker, inspired by the game &quot;Undertale&quot;. </p>
</div>
<div class='lg-article-sub am-g' id="sub"></div>
</div>
</div>
</div>
<div class="am-modal am-modal-prompt" tabindex="-1" id="confirm">
<div class="am-modal-dialog">
<div class="am-modal-hd" id="memtitle">提示</div>
<div class="am-modal-bd" id="memadmin">
标程仅供做题后或实在无思路时参考。<br>
请自觉、自律地使用该功能并请对自己的学习负责。<br>
如果发现恶意抄袭标程，将按照I类违反进行处理。<br>
</div>
<div class="am-modal-footer">
<span class="am-modal-btn" data-am-modal-cancel>取消</span>
<span class="am-modal-btn" data-am-modal-confirm>确定</span>
</div>
</div>
</div>
<script>
        $(document).ready(function () {
            $("#expandstd").click(function () {
                $('#confirm').modal({
                    relatedTarget: this,
                    onConfirm: function (e) {
                        $("#stdcode").slideDown();
                        $("#expandstd").hide();
                    }
                });
            });
            $("#submit").click(
                function () {
                    hide_artile();
                    $(document).scrollTop($(document).scrollTop() - 80);
                    var pid = $(this).attr("pid");
                    $.get("/problem/ajax_submit?pid=" + pid, function (data) {
                        var arr = eval('(' + data + ')');
                        if (arr['code'] == 201) {
                            $('.lg-article-sub').html(arr['more']['html']);
                        }
                        else if (arr['code'] == 200) {

                        }
                        else {
                            if (arr['code'] == 0 || arr['code'] == -3) {
                                backarticle();
                            }
                            show_alert("提交失败", arr['message']);
                        }
                    });
                }
            );
            $("button[title].am-btn,a[title].am-btn").poshytip({
                className: 'tip-twitter',
                showTimeout: 1,
                alignTo: 'target',
                alignX: 'center',
                alignY: 'bottom'
            });
            $('[name=showtag]').click(function () {
                $('.am-badge.am-hide').removeClass('am-hide');
            });
            $(".sample-copy").click(function() {
                var element = $(this).parents(".copy-region").find("pre");
                var text = $(element).text();
                var $temp = $("<textarea>");
                $("body").append($temp);
                $temp.val(text).select();
                document.execCommand("copy");
                $temp.remove();
                $(this).text("复制成功").removeClass("lg-bg-orange");

                var e = this;
                setTimeout(function() {
                    $(e).text("复制").addClass("lg-bg-orange");
                }, 500);
            });
        });
    </script>
</div>
<footer id="app-footer"></footer>
<div class="am-modal am-modal-alert" tabindex="-1" id="lg-alert">
<div class="am-modal-dialog">
<div class="am-modal-hd" id="lg-alert-title"></div>
<div class="am-modal-bd" id="lg-alert-message"></div>
<div class="am-modal-footer">
<span class="am-modal-btn">确定</span>
</div>
</div>
</div>
<script src="/js/ace/ace.js"></script>
<script src="https://cdn.luogu.org/js/vendor.js" data-manual></script>
<script src="https://cdn.luogu.org/js/jsmind.js" data-manual></script>
<script src="https://cdn.luogu.org/js/amazeui.min.js"></script>
<script src="https://cdn.luogu.org/js/highcharts.js"></script>
<script src="https://cdn.luogu.org/js/highcharts-more.js"></script>
<script src="/static/katex/katex.min.js"></script>
<script src="/static/katex/contrib/auto-render.min.js"></script>
<script src="https://cdn.luogu.org/markdown-palettes/markdown-palettes.min.js?ver=20190219"></script>
<script src="https://cdn.luogu.org/js/luogu3.js?ver=20190101"></script>
</body>
</html>
